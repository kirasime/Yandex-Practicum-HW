# Project: Supervised Learning: Model Quality

## Project Description
The online store "One Click" sells various products: children's goods, household items, small appliances, cosmetics, and even groceries. The store's report for the previous period showed that customer activity has started to decline. Attracting new customers is no longer as effective since most of the target audience is already aware of the store. A possible solution is to retain existing customers by offering personalized promotions.

"One Click" is a modern company, and its management prefers data-driven decisions rather than intuition. The company has a small digital technology department, and you will be interning there.

Your department has been assigned the task of developing a solution to personalize offers for regular customers to increase their shopping activity.

## Approach to the Problem
Your department head has already outlined the approach:
- Label customers based on their financial activity level: "declined" if the customer has reduced purchases, and "same level" if there is no change.
- Collect customer data in the following categories:
  - Communication with company employees.
  - Product purchasing behavior: what and how often customers buy.
  - Financial behavior: how much customers spend.
  - Website behavior: pages viewed and time spent.
- Visualize feature groups using an Ishikawa diagram.
- Develop a model to predict the likelihood of a decline in customer shopping activity over the next three months.
- Integrate additional financial department data on customer profitability: revenue generated by each customer over the past three months.
- Use model predictions and customer profitability data to segment customers and create personalized offers.

## Data Description
The project uses multiple datasets:
1. `market_file.csv` - Customer behavior data, including website activity, communications, and purchase patterns.
2. `market_money.csv` - Revenue data per customer.
3. `market_time.csv` - Time spent on the website by customers.
4. `money.csv` - Monthly profit data per customer for the past three months.

## Project Steps
1. **Load and Inspect Data**
   - Load the datasets, ensuring correct parsing.
   - Verify data matches descriptions.

2. **Data Preprocessing**
   - Clean and preprocess data as needed.

3. **Exploratory Data Analysis (EDA)**
   - Analyze customer activity over at least three months.
   - Draw conclusions based on the analysis.

4. **Data Merging**
   - Merge `market_file.csv`, `market_money.csv`, and `market_time.csv`.
   - Separate revenue and time data into individual columns for each period.

5. **Correlation Analysis**
   - Identify correlations among numerical features.
   - Address multicollinearity if necessary.

6. **Model Training with Pipelines**
   - Use `ColumnTransformer` to preprocess categorical and numerical features.
   - Train models: `KNeighborsClassifier`, `DecisionTreeClassifier`, `LogisticRegression`, and `SVC`.
   - Tune at least one hyperparameter for each model.
   - Select an evaluation metric and justify its choice.
   - Identify the best-performing model using a suitable strategy.

7. **Feature Importance Analysis**
   - Use SHAP to evaluate feature importance.
   - Determine which features significantly impact predictions.

8. **Customer Segmentation**
   - Segment customers based on model predictions and profitability data.
   - Analyze a selected segment and propose strategies to enhance their activity.
   - Provide recommendations for targeted marketing.

9. **Final Conclusion**
   - Summarize the task, dataset, and preprocessing steps.
   - Describe model selection and final choice.
   - Include insights and business recommendations for selected customer segments.

## Submission and Evaluation
- Submit the project in Jupyter Notebook.
- Code should be in `code` cells, explanations in `markdown` cells.
- Follow structured research methodology.
- Maintain code readability and organization.

## Evaluation Criteria
- Identification of data issues and applied fixes.
- Quality of visualizations and insights.
- Justification of preprocessing steps.
- Implementation of machine learning models and hyperparameter tuning.
- Selection and justification of evaluation metric.
- Customer segmentation and marketing recommendations.
- Code structure, readability, and comments.
- Overall conclusions and insights.

---

# Проект: Обучение с учителем: качество модели

## Описание проекта
Интернет-магазин "В один клик" продаёт различные товары: детские товары, товары для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт за прошлый период показал снижение активности покупателей. Привлекать новых клиентов становится менее эффективно, так как большинство целевой аудитории уже знакомо с магазином. Возможное решение — удержание существующих клиентов с помощью персонализированных предложений.

Компания принимает решения на основе данных, а не интуиции. У вас будет возможность поработать стажёром в цифровом отделе компании.

Вашей команде поручено разработать решение для персонализированных предложений, чтобы повысить активность постоянных клиентов.

## Подход к решению
Руководитель отдела сформировал стратегию:
- Промаркировать уровень финансовой активности клиентов: "снизилась" или "прежний уровень".
- Собрать данные по следующим группам:
  - Коммуникация с клиентом.
  - Покупательское поведение.
  - Финансовое поведение.
  - Поведение на сайте.
- Визуализировать признаки с помощью диаграммы Исикавы.
- Построить модель для предсказания вероятности снижения покупательской активности в следующие три месяца.
- Включить данные о прибыльности клиентов за последние три месяца.
- Сегментировать клиентов и разработать персонализированные предложения.

## Описание данных
1. `market_file.csv` - Данные о поведении клиента на сайте, коммуникациях и покупках.
2. `market_money.csv` - Данные о выручке с клиента.
3. `market_time.csv` - Время, проведённое клиентом на сайте.
4. `money.csv` - Среднемесячная прибыль за последние три месяца.

## Этапы работы
1. **Загрузка и проверка данных**
2. **Предобработка данных**
3. **Исследовательский анализ данных (EDA)**
4. **Объединение таблиц**
5. **Корреляционный анализ**
6. **Обучение моделей с пайплайнами**
7. **Анализ важности признаков (SHAP)**
8. **Сегментация покупателей**
9. **Финальные выводы**

## Критерии оценки
- Выявление проблем с данными и их исправление.
- Качественные визуализации и выводы.
- Аргументация предобработки данных.
- Реализация ML-моделей и подбор гиперпараметров.
- Выбор и обоснование метрики.
- Сегментация клиентов и маркетинговые рекомендации.
- Читаемость и аккуратность кода.
- Итоговые выводы и рекомендации.
