# Age Prediction Using Computer Vision

## ðŸ›’ Project Overview

As part of the digital transformation at the retail chain **Khleb-Sol'**, I implemented a computer vision system for **automatic age estimation** based on customer photos. This solution is designed to:

- ðŸ›ï¸ Analyze customer purchases and recommend products tailored to specific age groups.
- ðŸš« Ensure compliance by preventing alcohol sales to underage individuals.

---

## ðŸ§  Project Steps

1. **Exploratory Data Analysis**  
   Analyzed a dataset of facial photographs annotated with ages.

2. **Data Preparation**  
   Applied preprocessing techniques to get the data ready for training.

3. **Model Training**  
   Built and trained a neural network to estimate age from facial images.

---

## ðŸ“Š Model Analysis

The model is built on top of the **ResNet50** architecture, enhanced with custom layers for regression:

### ðŸ”§ Model Architecture

- `GlobalAveragePooling2D` â€” reduces spatial dimensions, preventing overfitting.  
- `Dense` â€” single neuron with ReLU activation for outputting age.

### ðŸ“ˆ Model Parameters

- Total parameters: `23,589,761`  
- Trainable parameters: `23,536,641`  
- Non-trainable (frozen) ResNet50 parameters: `53,120`

### ðŸš€ Training Details

- **Epochs:** 11  
- **Optimizer:** Adam  
- **Learning rate:** 0.0001  
- **Loss function:** Mean Squared Error (MSE)  
- **Metric:** Mean Absolute Error (MAE)

### ðŸ“‰ Training Dynamics

- **Train MAE:** Improved from `12.31` â†’ `2.65`  
- **Validation MAE:** Improved from `15.46` â†’ `6.70`

> âœ… Target MAE < 8 achieved successfully.

---

## âœ… Conclusion

- The model meets the technical requirement:  
  **Validation MAE = 6.70 < 8**
- Shows strong convergence â€” errors steadily decrease.  
- No signs of overfitting â€” the gap between training and validation errors is minimal.

---

## ðŸ”§ Suggestions for Improvement

- **Data Augmentation:**  
  Use light rotations to teach robustness to small angle changes.
  
- **Image Standardization:**  
  Normalize lighting and alignment to improve model performance.

- **Dataset Expansion:**  
  A larger dataset would enhance generalization.

- **Advanced Architecture:**  
  Using **EfficientNetB4** could improve both accuracy and speed.  
  However, the current environment is limited to **TensorFlow 2.1**, which prevents its use.

---

# _________________________

# ÐŸÑ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð° Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð·Ñ€ÐµÐ½Ð¸Ñ

## ðŸ›’ ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

Ð’ Ñ€Ð°Ð¼ÐºÐ°Ñ… Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÑÐµÑ‚Ð¸ ÑÑƒÐ¿ÐµÑ€Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¾Ð² **Â«Ð¥Ð»ÐµÐ±-Ð¡Ð¾Ð»ÑŒÂ»**, Ñ Ð²Ð½ÐµÐ´Ñ€Ð¸Ð» ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð·Ñ€ÐµÐ½Ð¸Ñ Ð´Ð»Ñ **Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°** Ð¿Ð¾ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°. Ð­Ñ‚Ð¾ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚:

- ðŸ›ï¸ ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ Ð¸ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð´Ð»Ñ Ð½ÑƒÐ¶Ð½Ð¾Ð¹ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð½Ð¾Ð¹ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹.
- ðŸš« ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ñƒ Ð°Ð»ÐºÐ¾Ð³Ð¾Ð»Ñ, Ð¸ÑÐºÐ»ÑŽÑ‡Ð°Ñ Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð½ÐµÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ð¾Ð»ÐµÑ‚Ð½Ð¸Ñ….

---

## ðŸ§  Ð­Ñ‚Ð°Ð¿Ñ‹ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

1. **ÐÐ½Ð°Ð»Ð¸Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ…**  
   Ð˜ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½ Ð½Ð°Ð±Ð¾Ñ€ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹ Ñ Ð°Ð½Ð½Ð¾Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð¾Ð¼.

2. **ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…**  
   ÐŸÑ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð° Ð¿Ñ€ÐµÐ´Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¸ Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ.

3. **ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸**  
   ÐŸÐ¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð° Ð¸ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð° Ð½ÐµÐ¹Ñ€Ð¾ÑÐµÑ‚ÑŒ Ð´Ð»Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¸ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð° Ð¿Ð¾ Ñ„Ð¾Ñ‚Ð¾.

---

## ðŸ“Š ÐÐ½Ð°Ð»Ð¸Ð· Ð¼Ð¾Ð´ÐµÐ»Ð¸

Ð’ Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð»ÐµÐ¶Ð¸Ñ‚ Ð¿Ñ€ÐµÐ´Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð½Ð°Ñ **ResNet50**, Ð´Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ð°Ñ ÑÐ»Ð¾ÑÐ¼Ð¸ Ð´Ð»Ñ Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ð¸:

### ðŸ”§ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð¼Ð¾Ð´ÐµÐ»Ð¸

- `GlobalAveragePooling2D` â€” ÑƒÑÑ€ÐµÐ´Ð½ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ñƒ, ÑƒÐ¼ÐµÐ½ÑŒÑˆÐ°ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ðµ.  
- `Dense` â€” Ð¾Ð´Ð¸Ð½ Ð½ÐµÐ¹Ñ€Ð¾Ð½ Ñ ReLU Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°.

### ðŸ“ˆ ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð¼Ð¾Ð´ÐµÐ»Ð¸

- Ð’ÑÐµÐ³Ð¾ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð²: `23,589,761`  
- ÐžÐ±ÑƒÑ‡Ð°ÐµÐ¼Ñ‹Ñ…: `23,536,641`  
- ÐÐµÐ¾Ð±ÑƒÑ‡Ð°ÐµÐ¼Ñ‹Ñ… (Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ðµ ÑÐ»Ð¾Ð¸ ResNet50): `53,120`

### ðŸš€ ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ

- **Ð­Ð¿Ð¾Ñ…Ð¸:** 11  
- **ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ‚Ð¾Ñ€:** Adam  
- **Learning rate:** 0.0001  
- **Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ð¾Ñ‚ÐµÑ€ÑŒ:** Ð¡Ñ€ÐµÐ´Ð½ÐµÐºÐ²Ð°Ð´Ñ€Ð°Ñ‚Ð¸Ñ‡Ð½Ð¾Ðµ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ðµ (MSE)  
- **ÐœÐµÑ‚Ñ€Ð¸ÐºÐ°:** Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° (MAE)

### ðŸ“‰ Ð”Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ

- **Train MAE:** Ð¡Ð½Ð¸Ð·Ð¸Ð»Ð°ÑÑŒ Ñ `12.31` Ð´Ð¾ `2.65`  
- **Validation MAE:** Ð¡Ð½Ð¸Ð·Ð¸Ð»Ð°ÑÑŒ Ñ `15.46` Ð´Ð¾ `6.70`

> âœ… Ð¦ÐµÐ»ÐµÐ²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ MAE < 8 ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚Ð¾.

---

## âœ… Ð’Ñ‹Ð²Ð¾Ð´Ñ‹

- ÐœÐ¾Ð´ÐµÐ»ÑŒ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑÐ¼:  
  **MAE Ð½Ð° Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ = 6.70 < 8**
- Ð¥Ð¾Ñ€Ð¾ÑˆÐ°Ñ ÑÑ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚ÑŒ â€” Ð¾ÑˆÐ¸Ð±ÐºÐ° ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ ÑÐ½Ð¸Ð¶Ð°ÐµÑ‚ÑÑ.  
- ÐŸÐµÑ€ÐµÐ¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð½Ðµ Ð½Ð°Ð±Ð»ÑŽÐ´Ð°ÐµÑ‚ÑÑ â€” Ñ€Ð°Ð·Ð½Ð¸Ñ†Ð° Ð¼ÐµÐ¶Ð´Ñƒ train Ð¸ validation MAE Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð°.

---

## ðŸ”§ Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ

- **ÐÑƒÐ³Ð¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ:**  
  Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¸Ðµ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚Ñ‹, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð²Ñ‹ÑÐ¸Ñ‚ÑŒ ÑƒÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ð¾ÑÑ‚ÑŒ Ðº Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸ÑŽ Ð»Ð¸Ñ†Ð°.

- **Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ:**  
  Ð’Ñ‹Ñ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð¾ÑÐ²ÐµÑ‰ÐµÐ½Ð¸Ñ, ÑÐ¼ÐµÑ‰ÐµÐ½Ð¸Ð¹ Ð¸ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚Ð¾Ð² ÑƒÐ»ÑƒÑ‡ÑˆÐ¸Ñ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹.

- **Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð°Ñ‚Ð°ÑÐµÑ‚Ð°:**  
  Ð‘Ð¾Ð»ÑŒÑˆÐµ Ð´Ð°Ð½Ð½Ñ‹Ñ… â€” Ð»ÑƒÑ‡ÑˆÐµ Ð¾Ð±Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ.

- **ÐŸÑ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ð°Ñ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°:**  
  **EfficientNetB4** Ð´Ð°Ð» Ð±Ñ‹ Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð»Ð°Ð½Ñ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸ Ð¸ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚Ð¸,  
  Ð½Ð¾ Ð¾Ð½ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð² Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ ÑÑ€ÐµÐ´Ðµ (TensorFlow 2.1).

---
